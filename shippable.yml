# Language setting
language: node_js

#build_image: drydock/u12nod:prod

# Version number
node_js:
  - 0.10.31
  - 0.11
 # - 5.0
 # - 4.2.2
  #- 0.12

# The path for Xunit to output test reports
env:
  global:
   - m1=one
  #- m2=two
  #- XUNIT_FILE=shippable/testresults/result.xml
  matrix:
   - m2=two
   
matrix:
  include: 
   - node_js: "4.2.2"
     env: 
      - m1=one
      #- m2=two
   #- node_js: "0.12" 
    # env: m1=one
  exclude: 
   - node_js: "0.11"
     env: 
      - m1=one
   #- node_js: "0.10.31"
    # env: 
     # - m1=one
     # - m2=two
     # - m2=two
    # env: m2=two
   #- node_js: "0.11"
  #   env: m1=one
    
install:
  - source ~/.nvm/nvm.sh && nvm install 0.12
  - node --version
  - npm install
#  - . installMongo.sh
#  - cat /etc/mongod.conf
#  - sudo mongod --smallfiles &
#  - sleep 15
#  - mongo --eval 'db.collection.find()'

# Create directories for test and coverage reports
before_script:
  - mkdir -p shippable/testresults
  - mkdir -p shippable/codecoverage

# Running the tests with grunt
script:
  - grunt

# Tell istanbul to generate a coverage report
after_script:
  - ./node_modules/.bin/istanbul cover grunt -- -u tdd
  - ./node_modules/.bin/istanbul report cobertura --dir  shippable/codecoverage/

